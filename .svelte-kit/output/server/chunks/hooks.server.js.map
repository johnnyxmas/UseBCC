{"version":3,"file":"hooks.server.js","sources":["../../../../src/hooks.server.js"],"sourcesContent":["/** @type {import('@sveltejs/kit').Handle} */\nexport async function handle({ event, resolve }) {\n  const response = await resolve(event);\n  \n  // Security headers to protect against common vulnerabilities\n  response.headers.set('X-Frame-Options', 'DENY');\n  response.headers.set('X-Content-Type-Options', 'nosniff');\n  response.headers.set('X-XSS-Protection', '1; mode=block');\n  response.headers.set('Referrer-Policy', 'strict-origin-when-cross-origin');\n  response.headers.set('Permissions-Policy', 'camera=(), microphone=(), geolocation=(), payment=(), usb=(), magnetometer=(), gyroscope=(), accelerometer=()');\n  \n  // Content Security Policy - adjust as needed for your specific requirements\n  const cspDirectives = [\n    \"default-src 'self'\",\n    \"script-src 'self' 'unsafe-inline'\", // unsafe-inline needed for SvelteKit\n    \"style-src 'self' 'unsafe-inline'\",  // unsafe-inline needed for inline styles\n    \"img-src 'self' data: https:\",\n    \"font-src 'self' data:\",\n    \"connect-src 'self'\",\n    \"media-src 'self'\",\n    \"object-src 'none'\",\n    \"frame-src 'none'\",\n    \"frame-ancestors 'none'\",\n    \"base-uri 'self'\",\n    \"form-action 'self'\",\n    \"manifest-src 'self'\",\n    \"worker-src 'self'\",\n    \"upgrade-insecure-requests\"\n  ];\n  \n  response.headers.set('Content-Security-Policy', cspDirectives.join('; '));\n  \n  // Strict Transport Security (HSTS) - only for HTTPS connections\n  if (event.url.protocol === 'https:') {\n    response.headers.set(\n      'Strict-Transport-Security',\n      'max-age=31536000; includeSubDomains; preload'\n    );\n  }\n  \n  return response;\n}"],"names":["async","handle","event","resolve","response","headers","set","join","url","protocol"],"mappings":"AACOA,eAAeC,GAAOC,MAAEA,EAAAC,QAAOA,IACpC,MAAMC,QAAiBD,EAAQD,GAG/BE,EAASC,QAAQC,IAAI,kBAAmB,QACxCF,EAASC,QAAQC,IAAI,yBAA0B,WAC/CF,EAASC,QAAQC,IAAI,mBAAoB,iBACzCF,EAASC,QAAQC,IAAI,kBAAmB,mCACxCF,EAASC,QAAQC,IAAI,qBAAsB,iHA+B3C,OAVAF,EAASC,QAAQC,IAAI,0BAlBC,CACpB,qBACA,oCACA,mCACA,8BACA,wBACA,qBACA,mBACA,oBACA,mBACA,yBACA,kBACA,qBACA,sBACA,oBACA,6BAG4DC,KAAK,OAGxC,WAAvBL,EAAMM,IAAIC,UACZL,EAASC,QAAQC,IACf,4BACA,gDAIGF,CACT"}