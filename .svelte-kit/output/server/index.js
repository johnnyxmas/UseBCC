import{w as e,B as t,v as r,g as s,s as n,p as o,T as a,I as i,E as c,c as l}from"./chunks/event-state.js";import{json as u,text as d,error as p}from"@sveltejs/kit";import{HttpError as h,SvelteKitError as f,Redirect as m,ActionFailure as _}from"@sveltejs/kit/internal";import{a as y,b as g,c as w,o as v,r as $,p as b}from"./chunks/environment.js";import*as k from"devalue";import{m as E,d as j,a as x,v as R,b as O,c as S,e as q,n as T,r as A,f as P,g as U}from"./chunks/exports.js";import{n as H,s as C}from"./chunks/lucide.js";import{p as N,s as L,r as W,o as z,g as D,a as I,b as M,c as F,d as G}from"./chunks/internal.js";import{parse as B,serialize as J}from"cookie";import*as V from"set-cookie-parser";const Q=["GET","POST","PUT","PATCH","DELETE","OPTIONS","HEAD"],X=["GET","POST","HEAD"];function Y(e,t){const r=[];let s;e.split(",").forEach((e,t)=>{const s=/([^/ \t]+)\/([^; \t]+)[ \t]*(?:;[ \t]*q=([0-9.]+))?/.exec(e);if(s){const[,e,n,o="1"]=s;r.push({type:e,subtype:n,q:+o,i:t})}}),r.sort((e,t)=>e.q!==t.q?t.q-e.q:"*"===e.subtype!=("*"===t.subtype)?"*"===e.subtype?1:-1:"*"===e.type!=("*"===t.type)?"*"===e.type?1:-1:e.i-t.i);let n=1/0;for(const o of t){const[e,t]=o.split("/"),a=r.findIndex(r=>!(r.type!==e&&"*"!==r.type||r.subtype!==t&&"*"!==r.subtype));-1!==a&&a<n&&(s=o,n=a)}return s}function Z(e){return function(e,...t){const r=e.headers.get("content-type")?.split(";",1)[0].trim()??"";return t.includes(r.toLowerCase())}(e,"application/x-www-form-urlencoded","multipart/form-data","text/plain")}function K(e){return e}function ee(e){return e instanceof h||e instanceof f?e.status:500}const te={"&":"&amp;",'"':"&quot;"},re={"&":"&amp;","<":"&lt;"},se="[\\ud800-\\udbff](?![\\udc00-\\udfff])|[\\ud800-\\udbff][\\udc00-\\udfff]|[\\udc00-\\udfff]",ne=new RegExp(`[${Object.keys(te).join("")}]|`+se,"g"),oe=new RegExp(`[${Object.keys(re).join("")}]|`+se,"g");function ae(e,t){const r=t?te:re;return e.replace(t?ne:oe,e=>2===e.length?e:r[e]??`&#${e.charCodeAt(0)};`)}function ie(e,t){return d(`${t} method not allowed`,{status:405,headers:{allow:ce(e).join(", ")}})}function ce(e){const t=Q.filter(t=>t in e);return("GET"in e||"HEAD"in e)&&t.push("HEAD"),t}function le(e,t,r){let s=e.templates.error({status:t,message:ae(r)});return d(s,{headers:{"content-type":"text/html; charset=utf-8"},status:t})}async function ue(e,t,r){var s;const n=ee(r=r instanceof h?r:(s=r)instanceof Error||s&&s.name&&s.message?s:new Error(JSON.stringify(s))),o=await de(e,t,r),a=Y(e.request.headers.get("accept")||"text/html",["application/json","text/html"]);return e.isDataRequest||"application/json"===a?u(o,{status:n}):le(t,n,o.message)}async function de(t,r,s){if(s instanceof h)return s.body;const n=ee(s),o=function(e){return e instanceof f?e.text:"Internal Error"}(s);return await e(t,()=>r.hooks.handleError({error:s,event:t,status:n,message:o}))??{message:o}}function pe(e,t){return new Response(void 0,{status:e,headers:{location:t}})}function he(e,t){return t.path?`Data returned from \`load\` while rendering ${e.route.id} is not serializable: ${t.message} (${t.path}). If you need to serialize/deserialize custom types, use transport hooks: https://svelte.dev/docs/kit/hooks#Universal-hooks-transport.`:""===t.path?`Data returned from \`load\` while rendering ${e.route.id} is not a plain object`:t.message}function fe(e){const t={};return e.uses&&e.uses.dependencies.size>0&&(t.dependencies=Array.from(e.uses.dependencies)),e.uses&&e.uses.search_params.size>0&&(t.search_params=Array.from(e.uses.search_params)),e.uses&&e.uses.params.size>0&&(t.params=Array.from(e.uses.params)),e.uses?.parent&&(t.parent=1),e.uses?.route&&(t.route=1),e.uses?.url&&(t.url=1),t}function me(e,t){return e._.prerendered_routes.has(t)||"/"===t.at(-1)&&e._.prerendered_routes.has(t.slice(0,-1))}function _e(e){return e.filter(e=>null!=e)}const ye="/__data.json",ge=".html__data.json";function we(e){return e.endsWith(".html")?e.replace(/\.html$/,ge):e.replace(/\/$/,"")+ye}const ve="/__route.js";function $e(e){return e.replace(/\/$/,"")+ve}function be(e){return"application/json"===Y(e.request.headers.get("accept")??"*/*",["application/json","text/html"])&&"POST"===e.request.method}function ke(e){return e instanceof _?new Error('Cannot "throw fail()". Use "return fail()"'):e}function Ee(e){return je({type:"redirect",status:e.status,location:e.location})}function je(e,t){return u(e,t)}function xe(e){if(e.default&&Object.keys(e).length>1)throw new Error("When using named actions, the default action cannot be used. See the docs for more info: https://svelte.dev/docs/kit/form-actions#named-actions")}async function Re(t,r){const s=new URL(t.request.url);let n="default";for(const e of s.searchParams)if(e[0].startsWith("/")){if(n=e[0].slice(1),"default"===n)throw new Error('Cannot use reserved action name "default"');break}const o=r[n];if(!o)throw new f(404,"Not Found",`No action with name '${n}' found`);if(!Z(t.request))throw new f(415,"Unsupported Media Type",`Form actions expect form-encoded data — received ${t.request.headers.get("content-type")}`);return e(t,()=>o(t))}function Oe(e,t,r){const s=Object.fromEntries(Object.entries(r).map(([e,t])=>[e,t.encode]));return Se(e,e=>k.stringify(e,s),t)}function Se(e,t,r){try{return t(e)}catch(s){const t=s;if(e instanceof Response)throw new Error(`Data returned from action inside ${r} is not serializable. Form actions need to return plain objects or fail(). E.g. return { success: true } or return fail(400, { message: "invalid" });`);if("path"in t){let e=`Data returned from action inside ${r} is not serializable: ${t.message}`;throw""!==t.path&&(e+=` (data.${t.path})`),new Error(e)}throw t}}async function qe({event:r,state:s,node:n,parent:o}){if(!n?.server)return null;let a=!0;const i={dependencies:new Set,params:new Set,parent:!1,route:!1,url:!1,search_params:new Set},c=n.server.load,l=n.server.trailingSlash;if(!c)return{type:"data",data:null,uses:i,slash:l};const u=E(r.url,()=>{a&&(i.url=!0)},e=>{a&&i.search_params.add(e)});s.prerendering&&j(u);let d=!1;const p=await e(r,()=>c.call(null,{...r,fetch:(e,s)=>{const n=new URL(e instanceof Request?e.url:e,r.url);return t&&d&&i.dependencies.has(n.href),r.fetch(e,s)},depends:(...e)=>{for(const t of e){const{href:e}=new URL(t,r.url);i.dependencies.add(e)}},params:new Proxy(r.params,{get:(e,r)=>(t&&d&&"string"==typeof r&&i.params.has(r),a&&i.params.add(r),e[r])}),parent:async()=>(t&&d&&i.parent,a&&(i.parent=!0),o()),route:new Proxy(r.route,{get:(e,r)=>(t&&d&&"string"==typeof r&&i.route,a&&(i.route=!0),e[r])}),url:u,untrack(e){a=!1;try{return e()}finally{a=!0}}}));return d=!0,{type:"data",data:p??null,uses:i,slash:l}}async function Te({event:t,fetched:r,node:s,parent:n,server_data_promise:o,state:a,resolve_opts:i,csr:c}){const l=await o,u=s?.universal?.load;if(!u)return l?.data??null;return await e(t,()=>u.call(null,{url:t.url,params:t.params,data:l?.data??null,route:t.route,fetch:Ae(t,a,r,c,i),setHeaders:t.setHeaders,depends:()=>{},parent:n,untrack:e=>e()}))??null}function Ae(e,t,r,s,n){const o=async(o,a)=>{const i=o instanceof Request&&o.body?o.clone().body:null,c=o instanceof Request&&[...o.headers].length?new Headers(o.headers):a?.headers;let l=await e.fetch(o,a);const u=new URL(o instanceof Request?o.url:o,e.url),d=u.origin===e.url.origin;let p;if(d)t.prerendering&&(p={response:l,body:null},t.prerendering.dependencies.set(u.pathname,p));else if("https:"===u.protocol||"http:"===u.protocol){if("no-cors"===(o instanceof Request?o.mode:a?.mode??"cors"))l=new Response("",{status:l.status,statusText:l.statusText,headers:l.headers});else{const t=l.headers.get("access-control-allow-origin");if(!t||t!==e.url.origin&&"*"!==t)throw new Error(`CORS error: ${t?"Incorrect":"No"} 'Access-Control-Allow-Origin' header is present on the requested resource`)}}const h=new Proxy(l,{get(t,s,n){async function l(s,n){const l=Number(t.status);if(isNaN(l))throw new Error(`response.status is not a number. value: "${t.status}" type: ${typeof t.status}`);r.push({url:d?u.href.slice(e.url.origin.length):u.href,method:e.request.method,request_body:o instanceof Request&&i?await Pe(i):a?.body,request_headers:c,response_body:s,response:t,is_b64:n})}if("arrayBuffer"===s)return async()=>{const e=await t.arrayBuffer();return p&&(p.body=new Uint8Array(e)),e instanceof ArrayBuffer&&await l(function(e){if(globalThis.Buffer)return Buffer.from(e).toString("base64");const t=new Uint8Array(new Uint16Array([1]).buffer)[0]>0;return btoa(new TextDecoder(t?"utf-16le":"utf-16be").decode(new Uint16Array(new Uint8Array(e))))}(e),!0),e};async function h(){const e=await t.text();return e&&"string"!=typeof e||await l(e,!1),p&&(p.body=e),e}return"text"===s?h:"json"===s?async()=>JSON.parse(await h()):Reflect.get(t,s,t)}});if(s){const t=l.headers.get;l.headers.get=r=>{const s=r.toLowerCase(),o=t.call(l.headers,s);if(o&&!s.startsWith("x-sveltekit-")){if(!n.filterSerializedResponseHeaders(s,o))throw new Error(`Failed to get response header "${s}" — it must be included by the \`filterSerializedResponseHeaders\` option: https://svelte.dev/docs/kit/hooks#Server-hooks-handle (at ${e.route.id})`)}return o}}return h};return(e,t)=>{const r=o(e,t);return r.catch(()=>{}),r}}async function Pe(e){let t="";const r=e.getReader(),s=new TextDecoder;for(;;){const{done:e,value:n}=await r.read();if(e)break;t+=s.decode(n)}return t}const Ue=[];function He(e,t=H){let r;const s=new Set;function n(t){if(C(e,t)&&(e=t,r)){const t=!Ue.length;for(const r of s)r[1](),Ue.push(r,e);if(t){for(let e=0;e<Ue.length;e+=2)Ue[e][0](Ue[e+1]);Ue.length=0}}}function o(t){n(t(e))}return{set:n,update:o,subscribe:function(a,i=H){const c=[a,i];return s.add(c),1===s.size&&(r=t(n,o)||H),a(e),()=>{s.delete(c),0===s.size&&r&&(r(),r=null)}}}}function Ce(...e){let t=5381;for(const r of e)if("string"==typeof r){let e=r.length;for(;e;)t=33*t^r.charCodeAt(--e)}else{if(!ArrayBuffer.isView(r))throw new TypeError("value must be a string or TypedArray");{const e=new Uint8Array(r.buffer,r.byteOffset,r.byteLength);let s=e.length;for(;s;)t=33*t^e[--s]}}return(t>>>0).toString(36)}const Ne={"<":"\\u003C","\u2028":"\\u2028","\u2029":"\\u2029"},Le=new RegExp(`[${Object.keys(Ne).join("")}]`,"g");const We=JSON.stringify,ze=new TextEncoder;function De(e){Me[0]||function(){function e(e){return 4294967296*(e-Math.floor(e))}let t=2;for(let r=0;r<64;t++){let s=!0;for(let e=2;e*e<=t;e++)if(t%e===0){s=!1;break}s&&(r<8&&(Ie[r]=e(t**.5)),Me[r]=e(t**(1/3)),r++)}}();const t=Ie.slice(0),r=function(e){const t=ze.encode(e),r=8*t.length,s=512*Math.ceil((r+65)/512),n=new Uint8Array(s/8);n.set(t),n[t.length]=128,Fe(n);const o=new Uint32Array(n.buffer);return o[o.length-2]=Math.floor(r/4294967296),o[o.length-1]=r,o}(e);for(let n=0;n<r.length;n+=16){const e=r.subarray(n,n+16);let s,o,a,i=t[0],c=t[1],l=t[2],u=t[3],d=t[4],p=t[5],h=t[6],f=t[7];for(let t=0;t<64;t++)t<16?s=e[t]:(o=e[t+1&15],a=e[t+14&15],s=e[15&t]=(o>>>7^o>>>18^o>>>3^o<<25^o<<14)+(a>>>17^a>>>19^a>>>10^a<<15^a<<13)+e[15&t]+e[t+9&15]|0),s=s+f+(d>>>6^d>>>11^d>>>25^d<<26^d<<21^d<<7)+(h^d&(p^h))+Me[t],f=h,h=p,p=d,d=u+s|0,u=l,l=c,c=i,i=s+(c&l^u&(c^l))+(c>>>2^c>>>13^c>>>22^c<<30^c<<19^c<<10)|0;t[0]=t[0]+i|0,t[1]=t[1]+c|0,t[2]=t[2]+l|0,t[3]=t[3]+u|0,t[4]=t[4]+d|0,t[5]=t[5]+p|0,t[6]=t[6]+h|0,t[7]=t[7]+f|0}const s=new Uint8Array(t.buffer);return Fe(s),Be(s)}const Ie=new Uint32Array(8),Me=new Uint32Array(64);function Fe(e){for(let t=0;t<e.length;t+=4){const r=e[t+0],s=e[t+1],n=e[t+2],o=e[t+3];e[t+0]=o,e[t+1]=n,e[t+2]=s,e[t+3]=r}}const Ge="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");function Be(e){const t=e.length;let r,s="";for(r=2;r<t;r+=3)s+=Ge[e[r-2]>>2],s+=Ge[(3&e[r-2])<<4|e[r-1]>>4],s+=Ge[(15&e[r-1])<<2|e[r]>>6],s+=Ge[63&e[r]];return r===t+1&&(s+=Ge[e[r-2]>>2],s+=Ge[(3&e[r-2])<<4],s+="=="),r===t&&(s+=Ge[e[r-2]>>2],s+=Ge[(3&e[r-2])<<4|e[r-1]>>4],s+=Ge[(15&e[r-1])<<2],s+="="),s}const Je=new Uint8Array(16);const Ve=new Set(["self","unsafe-eval","unsafe-hashes","unsafe-inline","none","strict-dynamic","report-sample","wasm-unsafe-eval","script"]),Qe=/^(nonce|sha\d\d\d)-/;class Xe{#e;#t;#r;#s;#n;#o;#a;#i;#c;#l;#u;#d;#p;#h;#f;constructor(e,t,r){this.#e=e,this.#c=t;const s=this.#c;this.#l=[],this.#u=[],this.#d=[],this.#p=[],this.#h=[];const n=s["script-src"]||s["default-src"],o=s["script-src-elem"],a=s["style-src"]||s["default-src"],i=s["style-src-attr"],c=s["style-src-elem"],l=e=>!!e&&!e.some(e=>"unsafe-inline"===e);this.#r=l(n),this.#s=l(o),this.#o=l(a),this.#a=l(i),this.#i=l(c),this.#t=this.#r||this.#s,this.#n=this.#o||this.#a||this.#i,this.script_needs_nonce=this.#t&&!this.#e,this.style_needs_nonce=this.#n&&!this.#e,this.#f=r}add_script(e){if(!this.#t)return;const t=this.#e?`sha256-${De(e)}`:`nonce-${this.#f}`;this.#r&&this.#l.push(t),this.#s&&this.#u.push(t)}add_style(e){if(!this.#n)return;const t=this.#e?`sha256-${De(e)}`:`nonce-${this.#f}`;if(this.#o&&this.#d.push(t),this.#a&&this.#p.push(t),this.#i){const e="sha256-9OlNO0DNEeaVzHL4RZwCLsBHA8WBQ8toBp/4F5XV2nc=",r=this.#c;!r["style-src-elem"]||r["style-src-elem"].includes(e)||this.#h.includes(e)||this.#h.push(e),t!==e&&this.#h.push(t)}}get_header(e=!1){const t=[],r={...this.#c};this.#d.length>0&&(r["style-src"]=[...r["style-src"]||r["default-src"]||[],...this.#d]),this.#p.length>0&&(r["style-src-attr"]=[...r["style-src-attr"]||[],...this.#p]),this.#h.length>0&&(r["style-src-elem"]=[...r["style-src-elem"]||[],...this.#h]),this.#l.length>0&&(r["script-src"]=[...r["script-src"]||r["default-src"]||[],...this.#l]),this.#u.length>0&&(r["script-src-elem"]=[...r["script-src-elem"]||[],...this.#u]);for(const s in r){if(e&&("frame-ancestors"===s||"report-uri"===s||"sandbox"===s))continue;const n=r[s];if(!n)continue;const o=[s];Array.isArray(n)&&n.forEach(e=>{Ve.has(e)||Qe.test(e)?o.push(`'${e}'`):o.push(e)}),t.push(o.join(" "))}return t.join("; ")}}class Ye extends Xe{get_meta(){const e=this.get_header(!0);if(e)return`<meta http-equiv="content-security-policy" content="${ae(e,!0)}">`}}class Ze extends Xe{constructor(e,t,r){if(super(e,t,r),Object.values(t).filter(e=>!!e).length>0){const e=t["report-to"]?.length??!1,r=t["report-uri"]?.length??!1;if(!e&&!r)throw Error("`content-security-policy-report-only` must be specified with either the `report-to` or `report-uri` directives, or both")}}}class Ke{nonce=function(){return crypto.getRandomValues(Je),Be(Je)}();csp_provider;report_only_provider;constructor({mode:e,directives:t,reportOnly:r},{prerender:s}){const n="hash"===e||"auto"===e&&s;this.csp_provider=new Ye(n,t,this.nonce),this.report_only_provider=new Ze(n,r,this.nonce)}get script_needs_nonce(){return this.csp_provider.script_needs_nonce||this.report_only_provider.script_needs_nonce}get style_needs_nonce(){return this.csp_provider.style_needs_nonce||this.report_only_provider.style_needs_nonce}add_script(e){this.csp_provider.add_script(e),this.report_only_provider.add_script(e)}add_style(e){this.csp_provider.add_style(e),this.report_only_provider.add_style(e)}}function et(){let e,t;return{promise:new Promise((r,s)=>{e=r,t=s}),fulfil:e,reject:t}}function tt(){const e=[et()];return{iterator:{[Symbol.asyncIterator]:()=>({next:async()=>{const t=await e[0].promise;return t.done||e.shift(),t}})},push:t=>{e[e.length-1].fulfil({value:t,done:!1}),e.push(et())},done:()=>{e[e.length-1].fulfil({done:!0})}}}function rt(e,t,r){const s={},n=e.slice(1),o=n.filter(e=>void 0!==e);let a=0;for(let i=0;i<t.length;i+=1){const e=t[i];let c=n[i-a];if(e.chained&&e.rest&&a&&(c=n.slice(i-a,i+1).filter(e=>e).join("/"),a=0),void 0!==c){if(!e.matcher||r[e.matcher](c)){s[e.name]=c;const r=t[i+1],l=n[i+1];r&&!r.rest&&r.optional&&l&&e.chained&&(a=0),r||l||Object.keys(s).length!==o.length||(a=0);continue}if(!e.optional||!e.chained)return;a++}else e.rest&&(s[e.name]="")}if(!a)return s}function st(e,t,r){const{errors:s,layouts:n,leaf:o}=e,a=[...s,...n.map(e=>e?.[1]),o[1]].filter(e=>"number"==typeof e).map(e=>`'${e}': () => ${nt(r._.client.nodes?.[e],t)}`).join(",\n\t\t");return[`{\n\tid: ${We(e.id)}`,`errors: ${We(e.errors)}`,`layouts: ${We(e.layouts)}`,`leaf: ${We(e.leaf)}`,`nodes: {\n\t\t${a}\n\t}\n}`].join(",\n\t")}function nt(e,t){if(!e)return"Promise.resolve({})";if("/"===e[0])return`import('${e}')`;if(""!==y)return`import('${y}/${e}')`;let r=function(e,t){const r=e.split(/[/\\]/),s=t.split(/[/\\]/);for(r.pop();r[0]===s[0];)r.shift(),s.shift();let n=r.length;for(;n--;)r[n]="..";return r.concat(s).join("/")}(t.pathname,`${g}/${e}`);return"."!==r[0]&&(r=`./${r}`),`import('${r}')`}function ot(e,t,r,s){const n=new Headers({"content-type":"application/javascript; charset=utf-8"});if(e){const o=st(e,r,s),a=`${function(e,t,r){const{errors:s,layouts:n,leaf:o}=e;let a="";for(const i of[...s,...n.map(e=>e?.[1]),o[1]]){if("number"!=typeof i)continue;const e=r._.client.css?.[i];for(const t of e??[])a+=`'${y||g}/${t}',`}return a?`${nt(r._.client.start,t)}.then(x => x.load_css([${a}]));`:""}(e,r,s)}\nexport const route = ${o}; export const params = ${JSON.stringify(t)};`;return{response:d(a,{headers:n}),body:a}}return{response:d("",{headers:n}),body:""}}const at={...(it=!1,{subscribe:He(it,ct).subscribe}),check:()=>!1};var it,ct;const lt=new TextEncoder;async function ut({branch:t,fetched:r,options:n,manifest:o,state:a,page_config:i,status:c,error:l=null,event:u,resolve_opts:p,action_result:h}){if(a.prerendering){if("nonce"===n.csp.mode)throw new Error('Cannot use prerendering if config.kit.csp.mode === "nonce"');if(n.app_template_contains_nonce)throw new Error("Cannot use prerendering if page template contains %sveltekit.nonce%")}const{client:f}=o._,m=new Set(f.imports),_=new Set(f.stylesheets),b=new Set(f.fonts),E=new Set,j=new Map;let x;const R="success"===h?.type||"failure"===h?.type?h.data??null:null;let O=g,S=y,q=We(g);if(a.prerendering?.fallback)n.hash_routing&&(q="new URL('.', location).pathname.slice(0, -1)");else{O=u.url.pathname.slice(g.length).split("/").slice(2).map(()=>"..").join("/")||".",q=`new URL(${We(O)}, location).pathname.slice(0, -1)`,(!y||"/"===y[0]&&"/_svelte_kit_assets"!==y)&&(S=O)}if(i.ssr){const r={stores:{page:He(null),navigating:He(null),updated:at},constructors:await Promise.all(t.map(({node:e})=>{if(!e.component)throw new Error(`Missing +page.svelte component for route ${u.route.id}`);return e.component()})),form:R};let s={};for(let e=0;e<t.length;e+=1)s={...s,...t[e].data},r[`data_${e}`]=s;r.page={error:l,params:u.params,route:u.route,status:c,url:u.url,data:s,form:R,state:{}},v({base:O,assets:S});const o={context:new Map([["__request__",{page:r.page}]])};try{x=e(u,()=>n.root.render(r,o))}finally{$()}for(const{node:e}of t){for(const t of e.imports)m.add(t);for(const t of e.stylesheets)_.add(t);for(const t of e.fonts)b.add(t);e.inline_styles&&!f.inline&&Object.entries(await e.inline_styles()).forEach(([e,t])=>j.set(e,t))}}else x={head:"",html:"",css:{code:"",map:null}};let T="",A=x.html;const P=new Ke(n.csp,{prerender:!!a.prerendering}),U=e=>e.startsWith("/")?g+e:`${S}/${e}`,H=f.inline?f.inline?.style:Array.from(j.values()).join("\n");if(H){const e=[];P.style_needs_nonce&&e.push(` nonce="${P.nonce}"`),P.add_style(H),T+=`\n\t<style${e.join("")}>${H}</style>`}for(const e of _){const t=U(e),r=['rel="stylesheet"'];if(j.has(e))r.push("disabled",'media="(max-width: 0)"');else if(p.preload({type:"css",path:t})){const e=['rel="preload"','as="style"'];E.add(`<${encodeURI(t)}>; ${e.join(";")}; nopush`)}T+=`\n\t\t<link href="${t}" ${r.join(" ")}>`}for(const e of b){const t=U(e);if(p.preload({type:"font",path:t})){T+=`\n\t\t<link ${['rel="preload"','as="font"',`type="font/${e.slice(e.lastIndexOf(".")+1)}"`,`href="${t}"`,"crossorigin"].join(" ")}>`}}const C=`__sveltekit_${n.version_hash}`,{data:W,chunks:z}=function(e,t,r,s,n){let o=1,a=0;const{iterator:i,push:c,done:l}=tt();function u(r){if("function"==typeof r?.then){const i=o++;return a+=1,r.then(e=>({data:e})).catch(async r=>({error:await de(e,t,r)})).then(async({data:r,error:o})=>{let d;a-=1;try{d=k.uneval({id:i,data:r,error:o},u)}catch{o=await de(e,t,new Error(`Failed to serialize promise while rendering ${e.route.id}`)),r=void 0,d=k.uneval({id:i,data:r,error:o},u)}const p=s.script_needs_nonce?` nonce="${s.nonce}"`:"";c(`<script${p}>${n}.resolve(${d})<\/script>\n`),0===a&&l()}),`${n}.defer(${i})`}for(const e in t.hooks.transport){const s=t.hooks.transport[e].encode(r);if(s)return`app.decode('${e}', ${k.uneval(s,u)})`}}try{return{data:`[${r.map(e=>{if(!e)return"null";const t={type:"data",data:e.data,uses:fe(e)};return e.slash&&(t.slash=e.slash),k.uneval(t,u)}).join(",")}]`,chunks:a>0?i:null}}catch(d){throw d.path=d.path.slice(1),new Error(he(e,d))}}(u,n,t.map(e=>e.server_data),P,C);if(i.ssr&&i.csr&&(A+=`\n\t\t\t${r.map(e=>function(e,t,r=!1){const s={};let n=null,o=null,a=!1;for(const[u,d]of e.response.headers)t(u,d)&&(s[u]=d),"cache-control"===u?n=d:"age"===u?o=d:"vary"===u&&"*"===d.trim()&&(a=!0);const i={status:e.response.status,statusText:e.response.statusText,headers:s,body:e.response_body},c=JSON.stringify(i).replace(Le,e=>Ne[e]),l=['type="application/json"',"data-sveltekit-fetched",`data-url="${ae(e.url,!0)}"`];if(e.is_b64&&l.push("data-b64"),e.request_headers||e.request_body){const t=[];e.request_headers&&t.push([...new Headers(e.request_headers)].join(",")),e.request_body&&t.push(e.request_body),l.push(`data-hash="${Ce(...t)}"`)}if(!r&&"GET"===e.method&&n&&!a){const e=/s-maxage=(\d+)/g.exec(n)??/max-age=(\d+)/g.exec(n);if(e){const t=+e[1]-+(o??"0");l.push(`data-ttl="${t}"`)}}return`<script ${l.join(" ")}>${c}<\/script>`}(e,p.filterSerializedResponseHeaders,!!a.prerendering)).join("\n\t\t\t")}`),i.csr){const e=o._.client.routes?.find(e=>e.id===u.route.id)??null;if(f.uses_env_dynamic_public&&a.prerendering&&m.add(`${w}/env.js`),!f.inline){const e=Array.from(m,e=>U(e)).filter(e=>p.preload({type:"js",path:e}));for(const t of e)E.add(`<${encodeURI(t)}>; rel="modulepreload"; nopush`),"modulepreload"!==n.preload_strategy?T+=`\n\t\t<link rel="preload" as="script" crossorigin="anonymous" href="${t}">`:a.prerendering&&(T+=`\n\t\t<link rel="modulepreload" href="${t}">`)}if(o._.client.routes&&a.prerendering&&!a.prerendering.fallback){const t=$e(u.url.pathname);a.prerendering.dependencies.set(t,ot(e,u.params,new URL(t,u.url),o))}const r=[],d=f.uses_env_dynamic_public&&a.prerendering,h=[`base: ${q}`];y&&h.push(`assets: ${We(y)}`),f.uses_env_dynamic_public&&h.push(`env: ${d?"null":We(N)}`),z&&(r.push("const deferred = new Map();"),h.push("defer: (id) => new Promise((fulfil, reject) => {\n\t\t\t\t\t\t\tdeferred.set(id, { fulfil, reject });\n\t\t\t\t\t\t})"),h.push("resolve: ({ id, data, error }) => {\n\t\t\t\t\t\t\tconst try_to_resolve = () => {\n\t\t\t\t\t\t\t\tif (!deferred.has(id)) {\n\t\t\t\t\t\t\t\t\tsetTimeout(try_to_resolve, 0);\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tconst { fulfil, reject } = deferred.get(id);\n\t\t\t\t\t\t\t\tdeferred.delete(id);\n\t\t\t\t\t\t\t\tif (error) reject(error);\n\t\t\t\t\t\t\t\telse fulfil(data);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttry_to_resolve();\n\t\t\t\t\t\t}"));const{remote_data:_}=s(u);if(_){const e={};for(const r in _)e[r]=await _[r];const t=e=>{for(const r in n.hooks.transport){const s=n.hooks.transport[r].encode(e);if(s)return`app.decode('${r}', ${k.uneval(s,t)})`}};h.push(`data: ${k.uneval(e,t)}`)}r.push(`${C} = {\n\t\t\t\t\t\t${h.join(",\n\t\t\t\t\t\t")}\n\t\t\t\t\t};`);const g=["element"];if(r.push("const element = document.currentScript.parentElement;"),i.ssr){const r={form:"null",error:"null"};R&&(r.form=function(e,t,r){const s=e=>{for(const t in r){const n=r[t].encode(e);if(n)return`app.decode('${t}', ${k.uneval(n,s)})`}};return Se(e,e=>k.uneval(e,s),t)}(R,u.route.id,n.hooks.transport)),l&&(r.error=k.uneval(l));const s=[`node_ids: [${t.map(({node:e})=>e.index).join(", ")}]`,`data: ${W}`,`form: ${r.form}`,`error: ${r.error}`];if(200!==c&&s.push(`status: ${c}`),o._.client.routes){if(e){const t=st(e,u.url,o).replaceAll("\n","\n\t\t\t\t\t\t\t");s.push(`params: ${k.uneval(u.params)}`,`server_route: ${t}`)}}else n.embedded&&s.push(`params: ${k.uneval(u.params)}`,`route: ${We(u.route)}`);const a="\t".repeat(d?7:6);g.push(`{\n${a}\t${s.join(`,\n${a}\t`)}\n${a}}`)}const v=f.inline?`${f.inline.script}\n\n\t\t\t\t\t__sveltekit_${n.version_hash}.app.start(${g.join(", ")});`:f.app?`Promise.all([\n\t\t\t\t\t\timport(${We(U(f.start))}),\n\t\t\t\t\t\timport(${We(U(f.app))})\n\t\t\t\t\t]).then(([kit, app]) => {\n\t\t\t\t\t\tkit.start(app, ${g.join(", ")});\n\t\t\t\t\t});`:`import(${We(U(f.start))}).then((app) => {\n\t\t\t\t\t\tapp.start(${g.join(", ")})\n\t\t\t\t\t});`;if(d?r.push(`import(${We(`${O}/${w}/env.js`)}).then(({ env }) => {\n\t\t\t\t\t\t${C}.env = env;\n\n\t\t\t\t\t\t${v.replace(/\n/g,"\n\t")}\n\t\t\t\t\t});`):r.push(v),n.service_worker){const e="";r.push(`if ('serviceWorker' in navigator) {\n\t\t\t\t\t\taddEventListener('load', function () {\n\t\t\t\t\t\t\tnavigator.serviceWorker.register('${U("service-worker.js")}'${e});\n\t\t\t\t\t\t});\n\t\t\t\t\t}`)}const $=`\n\t\t\t\t{\n\t\t\t\t\t${r.join("\n\n\t\t\t\t\t")}\n\t\t\t\t}\n\t\t\t`;P.add_script($),A+=`\n\t\t\t<script${P.script_needs_nonce?` nonce="${P.nonce}"`:""}>${$}<\/script>\n\t\t`}const D=new Headers({"x-sveltekit-page":"true","content-type":"text/html"});if(a.prerendering){const e=[],t=P.csp_provider.get_meta();t&&e.push(t),a.prerendering.cache&&e.push(`<meta http-equiv="cache-control" content="${a.prerendering.cache}">`),e.length>0&&(T=e.join("\n")+T)}else{const e=P.csp_provider.get_header();e&&D.set("content-security-policy",e);const t=P.report_only_provider.get_header();t&&D.set("content-security-policy-report-only",t),E.size&&D.set("link",Array.from(E).join(", "))}T+=x.head;const I=n.templates.app({head:T,body:A,assets:S,nonce:P.nonce,env:L}),M=await p.transformPageChunk({html:I,done:!0})||"";return z||D.set("etag",`"${Ce(M)}"`),z?new Response(new ReadableStream({async start(e){e.enqueue(lt.encode(M+"\n"));for await(const t of z)e.enqueue(lt.encode(t));e.close()},type:"bytes"}),{headers:D}):d(M,{status:c,headers:D})}class dt{data;constructor(e){this.data=e}layouts(){return this.data.slice(0,-1)}page(){return this.data.at(-1)}validate(){for(const t of this.layouts())t&&(R(t.server,t.server_id),O(t.universal,t.universal_id));const e=this.page();e&&(S(e.server,e.server_id),q(e.universal,e.universal_id))}#m(e){return this.data.reduce((t,r)=>r?.universal?.[e]??r?.server?.[e]??t,void 0)}csr(){return this.#m("csr")??!0}ssr(){return this.#m("ssr")??!0}prerender(){return this.#m("prerender")??!1}trailing_slash(){return this.#m("trailingSlash")??"never"}get_config(){let e={};for(const t of this.data)(t?.universal?.config||t?.server?.config)&&(e={...e,...t?.universal?.config,...t?.server?.config});return Object.keys(e).length?e:void 0}should_prerender_data(){return this.data.some(e=>e?.server?.load||void 0!==e?.server?.trailingSlash)}}async function pt({event:e,options:t,manifest:r,state:s,status:n,error:o,resolve_opts:a}){if(e.request.headers.get("x-sveltekit-error"))return le(t,n,o.message);const i=[];try{const c=[],l=await r._.nodes[0](),u=new dt([l]),d=u.ssr(),p=u.csr();if(d){s.error=!0;const t=qe({event:e,state:s,node:l,parent:async()=>({})}),n=await t,o=await Te({event:e,fetched:i,node:l,parent:async()=>({}),resolve_opts:a,server_data_promise:t,state:s,csr:p});c.push({node:l,server_data:n,data:o},{node:await r._.nodes[1](),data:null,server_data:null})}return await ut({options:t,manifest:r,state:s,page_config:{ssr:d,csr:p},status:n,error:await de(e,t,o),branch:c,fetched:i,event:e,resolve_opts:a})}catch(c){return c instanceof m?pe(c.status,c.location):le(t,ee(c),(await de(e,t,c)).message)}}const ht=new TextEncoder;function ft(e,t=200){return d("string"==typeof e?e:JSON.stringify(e),{status:t,headers:{"content-type":"application/json","cache-control":"private, no-store"}})}function mt(e){return ft({type:"redirect",location:e.location})}function _t(e,t,r){let s=1,n=0;const{iterator:o,push:a,done:i}=tt(),c={...Object.fromEntries(Object.entries(t.hooks.transport).map(([e,t])=>[e,t.encode])),Promise:r=>{if("function"==typeof r?.then){const o=s++;n+=1;let l="data";return r.catch(async r=>(l="error",de(e,t,r))).then(async r=>{let s;try{s=k.stringify(r,c)}catch{const r=await de(e,t,new Error(`Failed to serialize promise while rendering ${e.route.id}`));l="error",s=k.stringify(r,c)}n-=1,a(`{"type":"chunk","id":${o},"${l}":${s}}\n`),0===n&&i()}),o}}};try{return{data:`{"type":"data","nodes":[${r.map(e=>e?"error"===e.type||"skip"===e.type?JSON.stringify(e):`{"type":"data","data":${k.stringify(e.data,c)},"uses":${JSON.stringify(fe(e))}${e.slash?`,"slash":${JSON.stringify(e.slash)}`:""}}`:"null").join(",")}]}\n`,chunks:n>0?o:null}}catch(l){throw l.path="data"+l.path,new Error(he(e,l))}}async function yt(r,s,n,o,a,i,c){if(a.depth>10)return d(`Not found: ${r.url.pathname}`,{status:404});if(be(r)){const e=await o._.nodes[s.leaf]();return async function(e,t,r){const s=r?.actions;if(!s){const r=new f(405,"Method Not Allowed","POST method not allowed. No form actions exist for this page");return je({type:"error",error:await de(e,t,r)},{status:r.status,headers:{allow:"GET"}})}xe(s);try{const r=await Re(e,s);return je(r instanceof _?{type:"failure",status:r.status,data:Oe(r.data,e.route.id,t.hooks.transport)}:{type:"success",status:r?200:204,data:Oe(r,e.route.id,t.hooks.transport)})}catch(n){const r=n;return r instanceof m?Ee(r):je({type:"error",error:await de(e,t,ke(r))},{status:ee(r)})}}(r,n,e?.server)}try{const u=i.page();let p,h=200;if(function(e){return"POST"===e.request.method}(r)){const t=r.url.searchParams.get("/remote");if(p=t?await async function(t,r,s){const[n,o,a]=s.split("/"),i=r._.remotes,c=await(i[n]?.());let l=c?.[o];if(!l)return t.setHeaders({allow:"GET"}),{type:"error",error:new f(405,"Method Not Allowed","POST method not allowed. No form actions exist for this page")};a&&(l=e(t,()=>l.for(JSON.parse(a))));try{const r=await t.request.formData(),s=l.__.fn;return await e(t,()=>s(r)),{type:"success",status:200}}catch(u){const e=u;return e instanceof m?{type:"redirect",status:e.status,location:e.location}:{type:"error",error:ke(e)}}}(r,o,t):await async function(e,t){const r=t?.actions;if(!r)return e.setHeaders({allow:"GET"}),{type:"error",error:new f(405,"Method Not Allowed","POST method not allowed. No form actions exist for this page")};xe(r);try{const t=await Re(e,r);return t instanceof _?{type:"failure",status:t.status,data:t.data}:{type:"success",status:200,data:t}}catch(s){const e=s;return e instanceof m?{type:"redirect",status:e.status,location:e.location}:{type:"error",error:ke(e)}}}(r,u.server),"redirect"===p?.type)return pe(p.status,p.location);"error"===p?.type&&(h=ee(p.error)),"failure"===p?.type&&(h=p.status)}const y=i.prerender();if(y){const e=u.server;if(e?.actions)throw new Error("Cannot prerender pages with actions")}else if(a.prerendering)return new Response(void 0,{status:204});a.prerender_default=y;const g=i.should_prerender_data(),w=we(r.url.pathname),v=[],$=i.ssr(),b=i.csr();if(!(!1!==$||a.prerendering&&g))return t&&p&&r.request.headers.has("x-sveltekit-action"),await ut({branch:[],fetched:v,page_config:{ssr:!1,csr:b},status:h,error:null,event:r,options:n,manifest:o,state:a,resolve_opts:c});const k=[];let E=null;const j=i.data.map((e,t)=>{if(E)throw E;return Promise.resolve().then(async()=>{try{if(e===u&&"error"===p?.type)throw p.error;return await qe({event:r,state:a,node:e,parent:async()=>{const e={};for(let r=0;r<t;r+=1){const t=await j[r];t&&Object.assign(e,t.data)}return e}})}catch(s){throw E=s,E}})}),x=i.data.map((e,t)=>{if(E)throw E;return Promise.resolve().then(async()=>{try{return await Te({event:r,fetched:v,node:e,parent:async()=>{const e={};for(let r=0;r<t;r+=1)Object.assign(e,await x[r]);return e},resolve_opts:c,server_data_promise:j[t],state:a,csr:b})}catch(s){throw E=s,E}})});for(const e of j)e.catch(()=>{});for(const e of x)e.catch(()=>{});for(let e=0;e<i.data.length;e+=1){const t=i.data[e];if(t)try{const r=await j[e],s=await x[e];k.push({node:t,server_data:r,data:s})}catch(l){const t=K(l);if(t instanceof m){if(a.prerendering&&g){const e=JSON.stringify({type:"redirect",location:t.location});a.prerendering.dependencies.set(w,{response:d(e),body:e})}return pe(t.status,t.location)}const i=ee(t),u=await de(r,n,t);for(;e--;)if(s.errors[e]){const t=s.errors[e],l=await o._.nodes[t]();let d=e;for(;!k[d];)d-=1;const p=_e(k.slice(0,d+1)),h=new dt(p.map(e=>e.node));return await ut({event:r,options:n,manifest:o,state:a,resolve_opts:c,page_config:{ssr:h.ssr(),csr:h.csr()},status:i,error:u,branch:p.concat({node:l,data:null,server_data:null}),fetched:v})}return le(n,i,u.message)}else k.push(null)}if(a.prerendering&&g){let{data:e,chunks:t}=_t(r,n,k.map(e=>e?.server_data));if(t)for await(const r of t)e+=r;a.prerendering.dependencies.set(w,{response:d(e),body:e})}return await ut({event:r,options:n,manifest:o,state:a,resolve_opts:c,page_config:{csr:b,ssr:$},status:h,error:null,branch:!1===$?[]:_e(k),action_result:p,fetched:v})}catch(l){return await pt({event:r,options:n,manifest:o,state:a,status:500,error:l,resolve_opts:c})}}const gt=/[\x00-\x1F\x7F()<>@,;:"/[\]?={} \t]/;function wt(e){if(void 0===e?.path)throw new Error("You must specify a `path` when setting, deleting or serializing cookies")}function vt(e,t){if(!t)return!0;const r="."===t[0]?t.slice(1):t;return e===r||e.endsWith("."+r)}function $t(e,t){if(!t)return!0;const r=t.endsWith("/")?t.slice(0,-1):t;return e===r||e.startsWith(r+"/")}function bt(e,t){for(const r of t){const{name:t,value:s,options:n}=r;if(e.append("set-cookie",J(t,s,n)),n.path.endsWith(".html")){const r=we(n.path);e.append("set-cookie",J(t,s,{...n,path:r}))}}}function kt({event:e,options:t,manifest:r,state:s,get_cookie_header:n,set_internal:o}){const a=async(a,i)=>{const c=Et(a,i,e.url);let l=(a instanceof Request?a.mode:i?.mode)??"cors",u=(a instanceof Request?a.credentials:i?.credentials)??"same-origin";return t.hooks.handleFetch({event:e,request:c,fetch:async(a,i)=>{const d=Et(a,i,e.url),p=new URL(d.url);if(d.headers.has("origin")||d.headers.set("origin",e.url.origin),a!==c&&(l=(a instanceof Request?a.mode:i?.mode)??"cors",u=(a instanceof Request?a.credentials:i?.credentials)??"same-origin"),"GET"!==d.method&&"HEAD"!==d.method||("no-cors"!==l||p.origin===e.url.origin)&&p.origin!==e.url.origin||d.headers.delete("origin"),p.origin!==e.url.origin){if(`.${p.hostname}`.endsWith(`.${e.url.hostname}`)&&"omit"!==u){const e=n(p,d.headers.get("cookie"));e&&d.headers.set("cookie",e)}return fetch(d)}const h=y||g,f=decodeURIComponent(p.pathname),m=(f.startsWith(h)?f.slice(h.length):f).slice(1),_=`${m}/index.html`,w=r.assets.has(m)||m in r._.server_assets,v=r.assets.has(_)||_ in r._.server_assets;if(w||v){const e=w?m:_;if(s.read){const t=w?r.mimeTypes[m.slice(m.lastIndexOf("."))]:"text/html";return new Response(s.read(e),{headers:t?{"content-type":t}:{}})}if(W&&e in r._.server_assets){const t=r._.server_assets[e],s=r.mimeTypes[e.slice(e.lastIndexOf("."))];return new Response(W(e),{headers:{"Content-Length":""+t,"Content-Type":s}})}return await fetch(d)}if(me(r,g+f))return await fetch(d);if("omit"!==u){const t=n(p,d.headers.get("cookie"));t&&d.headers.set("cookie",t);const r=e.request.headers.get("authorization");r&&!d.headers.has("authorization")&&d.headers.set("authorization",r)}d.headers.has("accept")||d.headers.set("accept","*/*"),d.headers.has("accept-language")||d.headers.set("accept-language",e.request.headers.get("accept-language"));const $=await async function(e,t,r,s){if(e.signal){if(e.signal.aborted)throw new DOMException("The operation was aborted.","AbortError");let n=()=>{};const o=new Promise((t,r)=>{const s=()=>{r(new DOMException("The operation was aborted.","AbortError"))};e.signal.addEventListener("abort",s,{once:!0}),n=()=>e.signal.removeEventListener("abort",s)}),a=await Promise.race([Pt(e,t,r,{...s,depth:s.depth+1}),o]);return n(),a}return await Pt(e,t,r,{...s,depth:s.depth+1})}(d,t,r,s),b=$.headers.get("set-cookie");if(b)for(const e of V.splitCookiesString(b)){const{name:t,value:r,...s}=V.parseString(e,{decodeValues:!1}),n=s.path??(p.pathname.split("/").slice(0,-1).join("/")||"/");o(t,r,{path:n,encode:e=>e,...s})}return $}})};return(e,t)=>{const r=a(e,t);return r.catch(()=>{}),r}}function Et(e,t,r){return e instanceof Request?e:new Request("string"==typeof e?new URL(e,r):e,t)}let jt,xt,Rt;const Ot=({html:e})=>e,St=()=>!1,qt=({type:e})=>"js"===e||"css"===e,Tt=new Set(["GET","HEAD","POST"]),At=new Set(["GET","HEAD","OPTIONS"]);async function Pt(r,_,y,v){const $=new URL(r.url),b=$.pathname.endsWith(ve);const k=function(e){return e.endsWith(ye)||e.endsWith(ge)}($.pathname),E=function(e){return e.pathname.startsWith(`${g}/${w}/remote/`)&&e.pathname.replace(`${g}/${w}/remote/`,"")}($);if(_.csrf_check_origin&&r.headers.get("origin")!==$.origin){const e={status:403};if(E&&"GET"!==r.method)return u({message:"Cross-site remote requests are forbidden"},e);if(Z(r)&&("POST"===r.method||"PUT"===r.method||"PATCH"===r.method||"DELETE"===r.method)){const t=`Cross-site ${r.method} form submissions are forbidden`;return"application/json"===r.headers.get("accept")?u({message:t},e):d(t,e)}}if(_.hash_routing&&$.pathname!==g+"/"&&"/[fallback]"!==$.pathname)return d("Not found",{status:404});let R;b?$.pathname=function(e){return e.slice(0,-11)}($.pathname):k?($.pathname=function(e){return e.endsWith(ge)?e.slice(0,-16)+".html":e.slice(0,-12)}($.pathname)+("1"===$.searchParams.get(a)?"/":"")||"/",$.searchParams.delete(a),R=$.searchParams.get(i)?.split("").map(e=>"1"===e),$.searchParams.delete(i)):E&&($.pathname=g,$.search="");const O={},{cookies:S,new_cookies:q,get_cookie_header:U,set_internal:H,set_trailing_slash:C}=function(e,t){const r=e.headers.get("cookie")??"",s=B(r,{decode:e=>e});let n;const o={},a={httpOnly:!0,sameSite:"lax",secure:"localhost"!==t.hostname||"http:"!==t.protocol},i={get(e,s){const n=o[e];return n&&vt(t.hostname,n.options.domain)&&$t(t.pathname,n.options.path)?n.value:B(r,{decode:s?.decode})[e]},getAll(e){const s=B(r,{decode:e?.decode});for(const r of Object.values(o))vt(t.hostname,r.options.domain)&&$t(t.pathname,r.options.path)&&(s[r.name]=r.value);return Object.entries(s).map(([e,t])=>({name:e,value:t}))},set(e,t,r){e.match(gt),wt(r),l(e,t,{...a,...r})},delete(e,t){wt(t),i.set(e,"",{...t,maxAge:0})},serialize(e,r,s){wt(s);let o=s.path;if(!s.domain||s.domain===t.hostname){if(!n)throw new Error("Cannot serialize cookies until after the route is determined");o=A(n,o)}return J(e,r,{...a,...s,path:o})}},c=[];function l(e,r,s){if(!n)return void c.push(()=>l(e,r,s));let a=s.path;s.domain&&s.domain!==t.hostname||(a=A(n,a)),o[e]={name:e,value:r,options:{...s,path:a}}}return{cookies:i,new_cookies:o,get_cookie_header:function(e,t){const r={...s};for(const s in o){const t=o[s];if(!vt(e.hostname,t.options.domain))continue;if(!$t(e.pathname,t.options.path))continue;const n=t.options.encode||encodeURIComponent;r[t.name]=n(t.value)}if(t){const e=B(t,{decode:e=>e});for(const t in e)r[t]=e[t]}return Object.entries(r).map(([e,t])=>`${e}=${t}`).join("; ")},set_internal:l,set_trailing_slash:function(e){n=T(t.pathname,e),c.forEach(e=>e())}}}(r,$),L={[c]:l(v,_),cookies:S,fetch:null,getClientAddress:v.getClientAddress||(()=>{throw new Error("@sveltejs/adapter-auto does not specify getClientAddress. Please raise an issue")}),locals:{},params:{},platform:v.platform,request:r,route:{id:null},setHeaders:e=>{for(const t in e){const r=t.toLowerCase(),s=e[t];if("set-cookie"===r)throw new Error("Use `event.cookies.set(name, value, options)` instead of `event.setHeaders` to set cookies");if(r in O)throw new Error(`"${t}" header is already set`);O[r]=s,v.prerendering&&"cache-control"===r&&(v.prerendering.cache=s)}},url:$,isDataRequest:k,isSubRequest:v.depth>0,isRemoteRequest:!!E};L.fetch=kt({event:L,options:_,manifest:y,state:v,get_cookie_header:U,set_internal:H}),v.emulator?.platform&&(L.platform=await v.emulator.platform({config:{},prerender:!!v.prerendering?.fallback}));let W=$.pathname;if(!E){const e=v.prerendering?.inside_reroute;try{v.prerendering&&(v.prerendering.inside_reroute=!0),W=await _.hooks.reroute({url:new URL($),fetch:L.fetch})??$.pathname}catch{return d("Internal Server Error",{status:500})}finally{v.prerendering&&(v.prerendering.inside_reroute=e)}}try{W=P(W)}catch{return d("Malformed URI",{status:400})}if(W!==$.pathname&&!v.prerendering?.fallback&&me(y,W)){const e=new URL(r.url);e.pathname=k?we(W):b?$e(W):W;const t=await fetch(e,r),s=new Headers(t.headers);return s.has("content-encoding")&&(s.delete("content-encoding"),s.delete("content-length")),new Response(t.body,{headers:s,status:t.status,statusText:t.statusText})}let z=null;if(g&&!v.prerendering?.fallback){if(!W.startsWith(g))return d("Not found",{status:404});W=W.slice(g.length)||"/"}if(b)return async function(e,t,r){if(!r._.client.routes)return d("Server-side route resolution disabled",{status:400});let s=null,n={};const o=await r._.matchers();for(const a of r._.client.routes){const t=a.pattern.exec(e);if(!t)continue;const r=rt(t,a.params,o);if(r){s=a,n=x(r);break}}return ot(s,n,t,r).response}(W,new URL(r.url),y);if(W===`/${w}/env.js`)return function(e){return jt??=`export const env=${JSON.stringify(N)}`,xt??=`W/${Date.now()}`,Rt??=new Headers({"content-type":"application/javascript; charset=utf-8",etag:xt}),e.headers.get("if-none-match")===xt?new Response(void 0,{status:304,headers:Rt}):new Response(jt,{headers:Rt})}(r);if(!E&&W.startsWith(`/${w}`)){const e=new Headers;return e.set("cache-control","public, max-age=0, must-revalidate"),d("Not found",{status:404,headers:e})}if(!v.prerendering?.fallback&&!E){const e=await y._.matchers();for(const t of y._.routes){const r=t.pattern.exec(W);if(!r)continue;const s=rt(r,t.params,e);if(s){z=t,L.route={id:z.id},L.params=x(s);break}}}let D={transformPageChunk:Ot,filterSerializedResponseHeaders:St,preload:qt},I="never";try{const a=z?.page?new dt(await function(e,t){return Promise.all([...e.layouts.map(e=>null==e?e:t._.nodes[e]()),t._.nodes[e.leaf]()])}(z.page,y)):void 0;if(z){if($.pathname===g||$.pathname===g+"/")I="always";else if(a)I=a.trailing_slash();else if(z.endpoint){const e=await z.endpoint();I=e.trailingSlash??"never"}if(!k){const e=T($.pathname,I);if(e!==$.pathname&&!v.prerendering?.fallback)return new Response(void 0,{status:308,headers:{"x-sveltekit-normalize":"1",location:(e.startsWith("//")?$.origin+e:e)+("?"===$.search?"":$.search)}})}if(v.before_handle||v.emulator?.platform){let e={},t=!1;if(z.endpoint){const r=await z.endpoint();e=r.config??e,t=r.prerender??t}else a&&(e=a.get_config()??e,t=a.prerender());v.before_handle&&v.before_handle(L,e,t),v.emulator?.platform&&(L.platform=await v.emulator.platform({config:e,prerender:t}))}}C(I),!v.prerendering||v.prerendering.fallback||v.prerendering.inside_reroute||j($);const i=await e(L,()=>_.hooks.handle({event:L,resolve:(i,c)=>e(null,()=>async function(a,i,c){try{if(c&&(D={transformPageChunk:c.transformPageChunk||Ot,filterSerializedResponseHeaders:c.filterSerializedResponseHeaders||St,preload:c.preload||qt}),_.hash_routing||v.prerendering?.fallback)return await ut({event:a,options:_,manifest:y,state:v,page_config:{ssr:!1,csr:!0},status:200,error:null,branch:[],fetched:[],resolve_opts:D});if(E)return await async function(t,r,a,i){const[c,l,d]=i.split("/"),_=a._.remotes;_[c]||p(404);const y=(await _[c]())[l];y||p(404);const g=y.__,w=r.hooks.transport;let v;try{if("form"===g.type){if(!Z(t.request))throw new f(415,"Unsupported Media Type",`Form actions expect form-encoded data — received ${t.request.headers.get("content-type")}`);const r=await t.request.formData();v=JSON.parse(r.get("sveltekit:remote_refreshes")??"[]"),r.delete("sveltekit:remote_refreshes");const o=g.fn,a=await e(t,()=>o(r));return u({type:"result",result:n(a,w),refreshes:n({...s(t).refreshes,...await $(v)},w)})}if("command"===g.type){const{payload:r,refreshes:a}=await t.request.json(),i=o(r,w),c=await e(t,()=>y(i)),l=await $(a);return u({type:"result",result:n(c,w),refreshes:n({...s(t).refreshes,...l},w)})}const r="prerender"===g.type?d:new URL(t.request.url).searchParams.get("payload"),a=await e(t,()=>y(o(r,w)));return u({type:"result",result:n(a,w)})}catch(b){if(b instanceof m){const e={...s(t).refreshes??{},...await $(v??[])};return u({type:"redirect",location:b.location,refreshes:Object.keys(e).length>0?n(e,w):void 0})}return u({type:"error",error:await de(t,r,b),status:b instanceof h||b instanceof f?b.status:500},{headers:{"cache-control":"private, no-store"}})}async function $(r){return Object.fromEntries(await Promise.all(r.map(async r=>{const[s,n,i]=r.split("/"),c=a._.remotes[s];c||p(400,"Bad Request");const l=(await c())[n];return l||p(400,"Bad Request"),[r,await e(t,()=>l(o(i,w)))]})))}}(a,_,y,E);if(z){const t=a.request.method;let s;if(k)s=await async function(e,t,r,s,n,o,a){if(!t.page)return new Response(void 0,{status:404});try{const i=[...t.page.layouts,t.page.leaf],c=o??i.map(()=>!0);let l=!1;const u=new URL(e.url);u.pathname=T(u.pathname,a);const d={...e,url:u},p=i.map((e,t)=>function(e){let t,r=!1;return()=>r?t:(r=!0,t=e())}(async()=>{try{if(l)return{type:"skip"};const r=null==e?e:await s._.nodes[e]();return qe({event:d,state:n,node:r,parent:async()=>{const e={};for(let r=0;r<t;r+=1){const t=await p[r]();t&&Object.assign(e,t.data)}return e}})}catch(r){throw l=!0,r}})),_=p.map(async(e,t)=>c[t]?e():{type:"skip"});let y=_.length;const g=await Promise.all(_.map((t,s)=>t.catch(async t=>{if(t instanceof m)throw t;return y=Math.min(y,s+1),{type:"error",error:await de(e,r,t),status:t instanceof h||t instanceof f?t.status:void 0}}))),{data:w,chunks:v}=_t(e,r,g);return v?new Response(new ReadableStream({async start(e){e.enqueue(ht.encode(w));for await(const t of v)e.enqueue(ht.encode(t));e.close()},type:"bytes"}),{headers:{"content-type":"text/sveltekit-data","cache-control":"private, no-store"}}):ft(w)}catch(i){const t=i;return t instanceof m?mt(t):ft(await de(e,r,t),500)}}(a,z,_,y,v,R,I);else if(!z.endpoint||z.page&&!function(e){const{method:t,headers:r}=e.request;return!(!Q.includes(t)||X.includes(t))||("POST"!==t||"true"!==r.get("x-sveltekit-action"))&&"text/html"!==Y(e.request.headers.get("accept")??"*/*",["*","text/html"])}(a)){if(!z.page)throw new Error("Route is neither page nor endpoint. This should never happen");if(!i)throw new Error("page_nodes not found. This should never happen");if(Tt.has(t))s=await yt(a,z.page,_,y,v,i,D);else{const e=new Set(At),r=await y._.nodes[z.page.leaf]();if(r?.server?.actions&&e.add("POST"),"OPTIONS"===t)s=new Response(null,{status:204,headers:{allow:Array.from(e.values()).join(", ")}});else{s=ie([...e].reduce((e,t)=>(e[t]=!0,e),{}),t)}}}else s=await async function(t,r,s){const n=t.request.method;let o=r[n]||r.fallback;if("HEAD"===n&&!r.HEAD&&r.GET&&(o=r.GET),!o)return ie(r,n);const a=r.prerender??s.prerender_default;if(a&&(r.POST||r.PATCH||r.PUT||r.DELETE))throw new Error("Cannot prerender endpoints that have mutative methods");if(s.prerendering&&!s.prerendering.inside_reroute&&!a){if(s.depth>0)throw new Error(`${t.route.id} is not prerenderable`);return new Response(void 0,{status:204})}try{const r=await e(t,()=>o(t));if(!(r instanceof Response))throw new Error(`Invalid response from route ${t.url.pathname}: handler should return a Response object`);if(s.prerendering&&(!s.prerendering.inside_reroute||a)){const e=new Response(r.clone().body,{status:r.status,statusText:r.statusText,headers:new Headers(r.headers)});if(e.headers.set("x-sveltekit-prerender",String(a)),!s.prerendering.inside_reroute||!a)return e;e.headers.set("x-sveltekit-routeid",encodeURI(t.route.id)),s.prerendering.dependencies.set(t.url.pathname,{response:e,body:null})}return r}catch(i){if(i instanceof m)return new Response(void 0,{status:i.status,headers:{location:i.location}});throw i}}(a,await z.endpoint(),v);if("GET"===r.method&&z.page&&z.endpoint){const e=s.headers.get("vary")?.split(",")?.map(e=>e.trim().toLowerCase());e?.includes("accept")||e?.includes("*")||(s=new Response(s.body,{status:s.status,statusText:s.statusText,headers:new Headers(s.headers)}),s.headers.append("Vary","Accept"))}return s}if(v.error&&a.isSubRequest){const e=new Headers(r.headers);return e.set("x-sveltekit-error","true"),await fetch(r,{headers:e})}return v.error?d("Internal Server Error",{status:500}):0===v.depth?(t&&a.url.pathname,await pt({event:a,options:_,manifest:y,state:v,status:404,error:new f(404,"Not Found",`Not found: ${a.url.pathname}`),resolve_opts:D})):v.prerendering?d("not found",{status:404}):await fetch(r)}catch(l){return await ue(a,_,l)}finally{a.cookies.set=()=>{throw new Error("Cannot use `cookies.set(...)` after the response has been generated")},a.setHeaders=()=>{throw new Error("Cannot use `setHeaders(...)` after the response has been generated")}}}(i,a,c).then(e=>{for(const t in O){const r=O[t];e.headers.set(t,r)}return bt(e.headers,Object.values(q)),v.prerendering&&null!==i.route.id&&e.headers.set("x-sveltekit-routeid",encodeURI(i.route.id)),e}))}));if(200===i.status&&i.headers.has("etag")){let e=r.headers.get("if-none-match");e?.startsWith('W/"')&&(e=e.substring(2));const t=i.headers.get("etag");if(e===t){const e=new Headers({etag:t});for(const t of["cache-control","content-location","date","expires","vary","set-cookie"]){const r=i.headers.get(t);r&&e.set(t,r)}return new Response(void 0,{status:304,headers:e})}}if(k&&i.status>=300&&i.status<=308){const e=i.headers.get("location");if(e)return mt(new m(i.status,e))}return i}catch(M){if(M instanceof m){const e=k?mt(M):z?.page&&be(L)?Ee(M):pe(M.status,M.location);return bt(e.headers,Object.values(q)),e}return await ue(L,_,M)}}const Ut={get({type:e},t){throw new Error(`Cannot read values from $env/dynamic/${e} while prerendering (attempted to read env.${t.toString()}). Use $env/static/${e} instead`)}};let Ht;class Ct{#_;#y;constructor(e){this.#_=z,this.#y=e}async init({env:e,read:t}){const r={public_prefix:this.#_.env_public_prefix,private_prefix:this.#_.env_private_prefix},s=function(e,{public_prefix:t,private_prefix:r}){return Object.fromEntries(Object.entries(e).filter(([e])=>e.startsWith(r)&&(""===t||!e.startsWith(t))))}(e,r),n=function(e,{public_prefix:t,private_prefix:r}){return Object.fromEntries(Object.entries(e).filter(([e])=>e.startsWith(t)&&(""===r||!e.startsWith(r))))}(e,r);if(I(b?new Proxy({type:"private"},Ut):s),M(b?new Proxy({type:"public"},Ut):n),F(n),t){const e=e=>{const r=t(e);return r instanceof ReadableStream?r:new ReadableStream({async start(e){try{const t=await Promise.resolve(r);if(!t)return void e.close();const s=t.getReader();for(;;){const{done:t,value:r}=await s.read();if(t)break;e.enqueue(r)}e.close()}catch(t){e.error(t)}}})};G(e)}await(Ht??=(async()=>{try{const e=await D();this.#_.hooks={handle:e.handle||(({event:e,resolve:t})=>t(e)),handleError:e.handleError||(({status:e,error:t})=>{}),handleFetch:e.handleFetch||(({request:e,fetch:t})=>t(e)),handleValidationError:e.handleValidationError||(({issues:e})=>({message:"Bad Request"})),reroute:e.reroute||(()=>{}),transport:e.transport||{}},e.transport&&Object.fromEntries(Object.entries(e.transport).map(([e,t])=>[e,t.decode])),e.init&&await e.init()}catch(e){throw e}})())}async respond(e,t){return Pt(e,this.#_,this.#y,{...t,error:!1,depth:0})}}export{Ct as Server};
